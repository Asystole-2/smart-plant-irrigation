{% extends "layout.html" %}

{% block body %}
<div class="app-container">
    {% include 'components/menu.html' %}

    <main class="main-content">
        <header class="page-header">
            <h1 class="text-4xl font-extrabold text-text-primary">Account Settings</h1>
            <p class="text-text-muted">Manage your profile and system preferences.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-8">
            <section class="lg:col-span-1">
                <div class="card bg-secondary p-6 rounded-xl border border-border">
                    <h3 class="text-xl font-bold text-text-primary mb-6">Your Profile</h3>
                    <form action="/update-profile" method="POST" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-text-secondary mb-1">Username</label>
                            <input type="text" name="username" value="{{ user_profile.username }}" 
                                   class="w-full p-3 bg-primary border border-border rounded-lg text-text-primary">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary mb-1">Email</label>
                            <input type="email" name="email" value="{{ user_profile.email }}" 
                                   class="w-full p-3 bg-primary border border-border rounded-lg text-text-primary">
                        </div>
                        <button type="submit" class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold transition">
                            Save Profile
                        </button>
                    </form>
                </div>
            </section>

            {% if session.role == 'admin' %}
            <section class="lg:col-span-2">
                <div class="card bg-secondary p-6 rounded-xl border border-border">
                    <h3 class="text-xl font-bold text-text-primary mb-6">User Management (Admin)</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-text-secondary">
                            <thead class="border-b border-border text-text-muted text-sm">
                                <tr>
                                    <th class="pb-3 px-2">User</th>
                                    <th class="pb-3 px-2">Email</th>
                                    <th class="pb-3 px-2">Role</th>
                                    <th class="pb-3 px-2 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user in users %}
                                <tr class="border-b border-border/50 hover:bg-primary/30 transition">
                                    <td class="py-4 px-2 font-semibold text-text-primary">{{ user.username }}</td>
                                    <td class="py-4 px-2">{{ user.email }}</td>
                                    <td class="py-4 px-2">
                                        <span class="px-2 py-1 rounded-md text-xs {% if user.role == 'admin' %}bg-red-900/30 text-red-400{% else %}bg-blue-900/30 text-blue-400{% endif %}">
                                            {{ user.role|upper }}
                                        </span>
                                    </td>
                                    <td class="py-4 px-2 text-right">
                                        <button class="text-red-400 hover:text-red-300 text-sm">Delete</button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            {% endif %}
        </div>
    </main>
</div>
{% endblock %}